<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lamia AI | Home</title>
</head>

<body>
  <header class="topbar">
    <!-- hamburger -->
    <!-- story title -->
    <nav class="div div-topbar-group topbar-group-left">

      <button class="btn btn-topbar btn-menu btn-tertiary">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1m0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1" />
        </svg>
      </button>

      <button type="button" class="btn btn-topbar btn-new-story btn-tertiary" id="btn-new-story">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1q-.15.15-.15.36M20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83l3.75 3.75z" />
        </svg>
      </button>

    </nav>

    <nav class="div div-topbar-group topbar-group-center">
      <input type="text" name="story-name" class="input-tertiary occupy-width" id="input-story-name" placeholder="Legends of Terra">
    </nav>

    <nav class="div div-topbar-group topbar-group-right">
      <p id="p-backend-info">Backend: Unknown</p>

      <button class="btn btn-topbar btn-tertiary" id="btn-topbar-ai-endpoint">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M21.33 12.91c.09 1.55-.62 3.04-1.89 3.95l.77 1.49c.23.45.26.98.06 1.45c-.19.47-.58.84-1.06 1l-.79.25a1.69 1.69 0 0 1-1.86-.55L14.44 18c-.89-.15-1.73-.53-2.44-1.1c-.5.15-1 .23-1.5.23c-.88 0-1.76-.27-2.5-.79c-.53.16-1.07.23-1.62.22c-.79.01-1.57-.15-2.3-.45a4.1 4.1 0 0 1-2.43-3.61c-.08-.72.04-1.45.35-2.11c-.29-.75-.32-1.57-.07-2.33C2.3 7.11 3 6.32 3.87 5.82c.58-1.69 2.21-2.82 4-2.7c1.6-1.5 4.05-1.66 5.83-.37c.42-.11.86-.17 1.3-.17c1.36-.03 2.65.57 3.5 1.64c2.04.53 3.5 2.35 3.58 4.47c.05 1.11-.25 2.2-.86 3.13c.07.36.11.72.11 1.09m-5-1.41c.57.07 1.02.5 1.02 1.07a1 1 0 0 1-1 1h-.63c-.32.9-.88 1.69-1.62 2.29c.25.09.51.14.77.21c5.13-.07 4.53-3.2 4.53-3.25a2.59 2.59 0 0 0-2.69-2.49a1 1 0 0 1-1-1a1 1 0 0 1 1-1c1.23.03 2.41.49 3.33 1.3c.05-.29.08-.59.08-.89c-.06-1.24-.62-2.32-2.87-2.53c-1.25-2.96-4.4-1.32-4.4-.4c-.03.23.21.72.25.75a1 1 0 0 1 1 1c0 .55-.45 1-1 1c-.53-.02-1.03-.22-1.43-.56c-.48.31-1.03.5-1.6.56c-.57.05-1.04-.35-1.07-.9a.97.97 0 0 1 .88-1.1c.16-.02.94-.14.94-.77c0-.66.25-1.29.68-1.79c-.92-.25-1.91.08-2.91 1.29C6.75 5 6 5.25 5.45 7.2C4.5 7.67 4 8 3.78 9c1.08-.22 2.19-.13 3.22.25c.5.19.78.75.59 1.29c-.19.52-.77.78-1.29.59c-.73-.32-1.55-.34-2.3-.06c-.32.27-.32.83-.32 1.27c0 .74.37 1.43 1 1.83c.53.27 1.12.41 1.71.4q-.225-.39-.39-.81a1.038 1.038 0 0 1 1.96-.68c.4 1.14 1.42 1.92 2.62 2.05c1.37-.07 2.59-.88 3.19-2.13c.23-1.38 1.34-1.5 2.56-1.5m2 7.47l-.62-1.3l-.71.16l1 1.25zm-4.65-8.61a1 1 0 0 0-.91-1.03c-.71-.04-1.4.2-1.93.67c-.57.58-.87 1.38-.84 2.19a1 1 0 0 0 1 1c.57 0 1-.45 1-1c0-.27.07-.54.23-.76c.12-.1.27-.15.43-.15c.55.03 1.02-.38 1.02-.92"/></svg>
      </button>
    </nav>

  </header>

  <div class="panel panel-main">

    <div class="panel-left" id="panel-sub-story-index">
      <!-- List of stories -->
      <!-- <button type="button" class="btn btn-story-select">
        <p class="p-story-index-title">Story 1</p>
        <p class="p-story-index-blurb">Fear. The strongest emotion humanity had ever face. From the blistering heights of the tallest mountains, to the deepest trenches of the seas, humans...</p>
      </button> -->
    </div>

    <div class="panel-middle">
      <!-- Text area -->
      <div class="div-editor input-primary" id="div-editor-content" contenteditable="true">
        <div></div>
      </div>

      <div class="middle-panel-btns">
        <button class="btn btn-secondary btn-small" id="btn-undo">
          Undo
        </button>

        <button class="btn btn-secondary btn-small" id="btn-redo">
          Redo
        </button>

        <button class="btn btn-primary btn-small" id="btn-ai-generate-more">
          Generate More
        </button>
      </div>

    </div>

    <div class="panel-right">

      <nav class="div div-story-overview-tabs">
        <button type="button" class="btn btn-overview-tab" id="btn-overview-tab-story">Story</button>
        <button type="button" class="btn btn-overview-tab" id="btn-overview-tab-llm">AI</button>
      </nav>

      <div class="div div-story-overview form-row" id="div-story-overview-stats">

        <div class="div form-row">
          <div>
            <label for="story-description">Description</label>
            <div class="div div-editor input-secondary" id="div-editor-desc" contenteditable="true"></div>
          </div>
          <div>
            <label for="story-tags">Tags</label>
            <input type="text" name="story-tags" class="input-secondary" id="input-story-tags">
          </div>
        </div>

        <div class="separator"></div>

        <div class="div div-story-stats" id="div-story-stats">
          <h2 class="header header-story-overview">Story Statistics</h2>
          <p class="p-story-overview" id="p-word-count">12,000 words</p>
          <p class="p-story-overview" id="p-character-count">40,000 characters</p>
        </div>

        <div class="div div-export-panel">
          <h2>Export</h2>

          <button type="button" class="btn btn-story-panel btn-secondary" id="btn-export-text">
            Export as Text
          </button>

          <button type="button" class="btn btn-story-panel btn-secondary" id="btn-export-json">
            Export as JSON
          </button>

        </div>

        <div class="div div-story-dangerous warn" id="warn-dangerous-actions" style="text-align: center;">
          <h2 class="header header-story-overview">Dangerous!</h2>

          <button class="btn btn-story-panel btn-secondary" id="btn-archive-story">
            Archive Story
          </button>

          <button class="btn btn-story-panel btn-secondary" id="btn-delete-story">
            Permanently Delete Story
          </button>

        </div>
      </div>

      <div class="div div-story-overview gr-hidden" id="div-story-overview-llm-settings">
        <label for="llm-ctx-len" title="Maximum number of tokens visible to the LLM">Context Length</label>
        <input type="number" name="llm-ctx-len" class="input input-llm input-secondary" id="input-llm-ctx-len" min="256" step="1" value="2048" placeholder="2048">

        <label for="llm-res-len" title="Amount of tokens to generate">Response Length</label>
        <input type="number" name="llm-res-len" class="input input-llm input-secondary" id="input-llm-res-len" min="1" step="1" value="120">

        <label for="llm-temp" title="How creative the LLM should be">Temperature</label>
        <input type="number" name="llm-temp" class="input input-llm input-secondary" id="input-llm-temp" min="0" value="1.15">

        <label for="llm-rep-pen" title="How creative the LLM should be">Repetition Penalty</label>
        <input type="number" name="llm-rep-pen" class="input input-llm input-secondary" id="input-llm-rep-pen" min="1" value="1.07">

        <label for="llm-top-p" title="Makes unlikely tokens less likely to appear">Top-p</label>
        <input type="number" name="llm-top-p" class="input input-llm input-secondary" id="input-llm-top-p" min="0" max="1" value="0.92">

        <label for="llm-top-k" title="Allow only the k-th most likely tokens to appear">Top-k</label>
        <input type="number" name="llm-top-k" class="input input-llm input-secondary" id="input-llm-top-k" min="1" value="100">

        <!-- TODO: style this -->
        <label for="llm-stream-type">Streaming Mode</label>
        <select name="llm-stream-type" id="select-llm-stream-type">
          <option value="sse" selected>SSE</option>
          <option value="polling">Polling</option>
          <option value="none">None</option>
        </select>
      </div>
    </div>
  </div>

  <div class="div div-popup-shadow" style="display: none;" id="div-popup-shadow">

    <div class="div div-popup" id="div-ai-selector-popup">
      <form action="#">
        <label for="llm-url">AI Endpoint</label>
        <input type="text" name="llm-url" class="input-secondary" id="input-llm-endpoint-uri" value="http://localhost:5001" placeholder="http://localhost:5001">

        <p id="p-llm-model-name">Model: None</p>

        <button type="button" class="btn btn-primary" id="btn-llm-selector-exit">Exit</button>
      </form>
    </div>

  </div>

  <footer>

  </footer>

  <!-- <script type="module" src="home-import.ts"></script> -->

  <script type="module" src="js/encryption.js"></script>
  <script type="module" src="js/lamiaApi.js"></script>
  <script type="module" src="js/koboldCppApi.js"></script>
  <script type="module" src="js/events.js"></script>
  <script type="module" src="js/home/storyObject.js"></script>
  <script type="module" src="js/home/homeState.js"></script>
  <script type="module" src="js/home/globalHomeState.js"></script>
  <script type="module" src="js/home/homeViewUtil.js"></script>

  <script type="module" src="js/home/llmSelector.js"></script>

  <script type="module" src="js/home/storyOverviewTabsView.js"></script>
  <script type="module" src="js/home/storyOverviewLlm.js"></script>
  <script type="module" src="js/home/storyOverviewExport.js"></script>

  <script type="module" src="js/home/homeView.js"></script>
  <script type="module" src="js/home/homeController.js"></script>
  <script type="module" src="js/home/home.js"></script>
</body>
</html>